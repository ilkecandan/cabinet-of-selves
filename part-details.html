<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Meet Your Part</title>
    <link rel="stylesheet" href="styles.css">
    <script defer src="part-details.js"></script>
</head>
<body>
<header class="main-header">
    <h1 id="partTitle">Meet Your Part</h1>
    <p id="pageDescription">This is a gentle place to explore and understand this part of you.</p>
</header>

<!-- Language Selector -->
<div class="language-selector">
    <label for="language">ğŸŒ</label>
    <select id="language" onchange="switchLanguage(this.value)">
        <option value="en">English</option>
        <option value="tr">TÃ¼rkÃ§e</option>
        <option value="de">Deutsch</option>
    </select>
</div>

<main class="part-details-box">
    <!-- Image Upload and Preview -->
    <img id="partImagePreview" src="images/girl.jpg" class="part-image-small">
    <input type="file" id="partImageInput" accept="image/*">

    <label id="labelKnownSince">ğŸŒ± How long have you known this part?</label>
    <input type="text" id="partSince" placeholder="A long time, since childhood, etc.">

    <label id="labelWants">ğŸ’¬ What does this part want for you?</label>
    <textarea id="partWants"></textarea>

    <label id="labelWorksWith">ğŸŒŸ Which parts does this part work well with?</label>
    <input type="text" id="partWorksWith">

    <label id="labelClashesWith">âš”ï¸ Which parts does this part clash with?</label>
    <input type="text" id="partClashesWith">

    <label id="labelRole">ğŸ­ What role does this part play?</label>
    <input type="text" id="partRole">

    <button onclick="savePartDetails()" id="saveButton">ğŸ’¾ Save Part Details</button>
    <button onclick="location.href='index.html'" id="backCabinetButton">â¬…ï¸ Back to Cabinet</button>
    <button onclick="location.href='parts.html'" id="backPartsButton">ğŸ“‚ Back to All Parts</button>
</main>

<script>
    const params = new URLSearchParams(window.location.search);
    const partName = params.get('part');

    // Load saved part data (including image)
    let part = JSON.parse(localStorage.getItem(`part-${partName}`)) || {};

    document.getElementById('partTitle').innerText = `Meet ${partName}`;

    // Pre-fill all fields and set image preview (use saved image or default)
    document.getElementById('partSince').value = part.knownSince || '';
    document.getElementById('partWants').value = part.wants || '';
    document.getElementById('partWorksWith').value = part.worksWith || '';
    document.getElementById('partClashesWith').value = part.clashesWith || '';
    document.getElementById('partRole').value = part.role || '';
    document.getElementById('partImagePreview').src = part.image || 'images/girl.jpg';

    // Handle image upload and immediate save
    document.getElementById('partImageInput').addEventListener('change', (event) => {
        const file = event.target.files[0];

        if (file) {
            const reader = new FileReader();
            reader.onload = () => {
                document.getElementById('partImagePreview').src = reader.result;
                part.image = reader.result;
                localStorage.setItem(`part-${partName}`, JSON.stringify(part));
                alert('âœ… Your image has been uploaded and saved!');
            };
            reader.readAsDataURL(file);
        }
    });

    function savePartDetails() {
        part.knownSince = document.getElementById('partSince').value;
        part.wants = document.getElementById('partWants').value;
        part.worksWith = document.getElementById('partWorksWith').value;
        part.clashesWith = document.getElementById('partClashesWith').value;
        part.role = document.getElementById('partRole').value;

        localStorage.setItem(`part-${partName}`, JSON.stringify(part));
        alert('âœ… Details saved successfully!');
    }

    const translations = {
        en: {
            pageTitle: "Meet Your Part",
            pageDescription: "This is a gentle place to explore and understand this part of you.",
            labelKnownSince: "ğŸŒ± How long have you known this part?",
            labelWants: "ğŸ’¬ What does this part want for you?",
            labelWorksWith: "ğŸŒŸ Which parts does this part work well with?",
            labelClashesWith: "âš”ï¸ Which parts does this part clash with?",
            labelRole: "ğŸ­ What role does this part play?",
            saveButton: "ğŸ’¾ Save Part Details",
            backCabinetButton: "â¬…ï¸ Back to Cabinet",
            backPartsButton: "ğŸ“‚ Back to All Parts",
            knownSincePlaceholder: "A long time, since childhood, etc."
        },
        tr: {
            pageTitle: "ParÃ§anÄ±zÄ± TanÄ±yÄ±n",
            pageDescription: "Bu, bu parÃ§anÄ±zÄ± keÅŸfetmek ve anlamak iÃ§in nazik bir alandÄ±r.",
            labelKnownSince: "ğŸŒ± Bu parÃ§ayÄ± ne zamandÄ±r tanÄ±yorsunuz?",
            labelWants: "ğŸ’¬ Bu parÃ§a sizden ne istiyor?",
            labelWorksWith: "ğŸŒŸ Bu parÃ§a hangi parÃ§alarla iyi Ã§alÄ±ÅŸÄ±yor?",
            labelClashesWith: "âš”ï¸ Bu parÃ§a hangi parÃ§alarla Ã§atÄ±ÅŸÄ±yor?",
            labelRole: "ğŸ­ Bu parÃ§a hangi rolÃ¼ oynuyor?",
            saveButton: "ğŸ’¾ ParÃ§a DetaylarÄ±nÄ± Kaydet",
            backCabinetButton: "â¬…ï¸ Kabine Geri DÃ¶n",
            backPartsButton: "ğŸ“‚ TÃ¼m ParÃ§alar'a Geri DÃ¶n",
            knownSincePlaceholder: "Uzun zamandÄ±r, Ã§ocukluktan beri, vb."
        },
        de: {
            pageTitle: "Lerne deinen Teil kennen",
            pageDescription: "Dies ist ein sanfter Ort, um diesen Teil von dir zu erkunden und zu verstehen.",
            labelKnownSince: "ğŸŒ± Wie lange kennst du diesen Teil?",
            labelWants: "ğŸ’¬ Was will dieser Teil von dir?",
            labelWorksWith: "ğŸŒŸ Mit welchen Teilen arbeitet dieser Teil gut zusammen?",
            labelClashesWith: "âš”ï¸ Mit welchen Teilen gerÃ¤t dieser Teil in Konflikt?",
            labelRole: "ğŸ­ Welche Rolle spielt dieser Teil?",
            saveButton: "ğŸ’¾ Teil speichern",
            backCabinetButton: "â¬…ï¸ ZurÃ¼ck zum Kabinett",
            backPartsButton: "ğŸ“‚ ZurÃ¼ck zu allen Teilen",
            knownSincePlaceholder: "Seit langer Zeit, seit der Kindheit, etc."
        }
    };

    function switchLanguage(lang) {
        localStorage.setItem('language', lang);
        const t = translations[lang];

        document.title = t.pageTitle;
        document.getElementById('partTitle').innerText = t.pageTitle;
        document.getElementById('pageDescription').innerText = t.pageDescription;
        document.getElementById('labelKnownSince').innerText = t.labelKnownSince;
        document.getElementById('labelWants').innerText = t.labelWants;
        document.getElementById('labelWorksWith').innerText = t.labelWorksWith;
        document.getElementById('labelClashesWith').innerText = t.labelClashesWith;
        document.getElementById('labelRole').innerText = t.labelRole;
        document.getElementById('saveButton').innerText = t.saveButton;
        document.getElementById('backCabinetButton').innerText = t.backCabinetButton;
        document.getElementById('backPartsButton').innerText = t.backPartsButton;

        document.getElementById('partSince').placeholder = t.knownSincePlaceholder;
    }

    document.addEventListener('DOMContentLoaded', () => {
        const lang = localStorage.getItem('language') || 'en';
        document.getElementById('language').value = lang;
        switchLanguage(lang);
    });
</script>

</body>
</html>
